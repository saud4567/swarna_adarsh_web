version: 2.1

orbs:
  aws-cli: circleci/aws-cli@2.0.0

jobs:
  build_and_deploy:
    docker:
      - image: circleci/node:14.17.0
    working_directory: ~/swarna_adarsh_web  # Change to your project directory
    steps:
      - checkout
      - run:
          name: Install Dependencies
          command: npm install --legacy-peer-deps
      - run:
          name: Build
          command: npm run build
      - aws-cli/install
      - aws-cli/setup:
          aws-access-key-id: "AKIATCKASRC3AZX42AYA"
          aws-secret-access-key: "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"
          aws-region: $AWS_REGION
      - run:
          name: Deploy to S3
          command: |
            aws s3 sync build/ s3://my-test-1-buck

workflows:
  deploy-to-s3:
    jobs:
      - build_and_deploy

